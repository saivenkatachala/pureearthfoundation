<!DOCTYPE html>
<html>
<head>
  <title>Property Registration Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" type="image/png" href="logo.png" />
  <style>
    :root {
      --primary: #ae2012;
      --primary-dark: #8a1a0e;
      --secondary: #4CAF50;
      --secondary-dark: #45a049;
      --accent: #005f73;
      --light-bg: #f8f9fa;
      --card-bg: #ffffff;
      --text: #333333;
      --text-light: #6c757d;
      --border: #dee2e6;
      --shadow: 0 4px 12px rgba(0,0,0,0.08);
      --shadow-hover: 0 6px 16px rgba(0,0,0,0.12);
      --success: #28a745;
      --error: #dc3545;
      --radius: 8px;
      --transition: all 0.3s ease;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--light-bg);
      padding: 15px 10px;
      line-height: 1.6;
      color: var(--text);
      font-size: 16px; /* Base font size for mobile */
    }

    .container {
      max-width: 850px;
      margin: auto;
      background: var(--card-bg);
      padding: 20px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      transition: var(--transition);
    }

    .container:hover {
      box-shadow: var(--shadow-hover);
    }

    .logo-box {
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 0;
      margin: 0 auto 5px auto;
    }

    .logo {
      max-width: 180px;
      height: auto;
      transition: transform 0.2s ease;
    }

    .logo:hover {
      transform: scale(1.02);
    }

    h1 {
      text-align: center;
      color: var(--primary);
      margin: 10px 0 15px;
      font-size: 1.6rem; /* Using rem for responsive sizing */
      padding-bottom: 10px;
      position: relative;
    }

    h1:after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 70px;
      height: 3px;
      background: var(--primary);
      border-radius: 3px;
    }

    h3 {
      color: var(--accent);
      margin: 20px 0 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border);
      font-size: 1.3rem;
    }

    p {
      text-align: justify;
      margin-bottom: 20px;
      color: var(--text);
      font-size: 1rem;
      line-height: 1.5;
    }

    form {
      margin-top: 1px;
    }

    .form-section {
      margin-bottom: 25px;
      padding-bottom: 20px;
      border-bottom: 1px dashed var(--border);
    }

    .form-section:last-of-type {
      border-bottom: none;
    }

    label {
      display: block;
      margin-top: 18px;
      font-weight: 600;
      color: var(--text);
      font-size: 1rem;
    }

    input, select, textarea {
      width: 100%;
      box-sizing: border-box;
      padding: 14px 15px; /* Slightly larger for mobile touch */
      margin-top: 8px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      font-size: 16px; /* Prevents zoom on iOS */
      transition: var(--transition);
      background: var(--card-bg);
      color: var(--text);
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(0, 95, 115, 0.1);
    }

    input:focus::placeholder {
      color: transparent;
    }

    textarea { 
      resize: vertical; 
      min-height: 100px;
    }

    .radio-group { 
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap; /* Allows wrapping on small screens */
      gap: 15px;
    }

    .radio-group label {
      display: inline-flex;
      align-items: center;
      margin-top: 0;
      font-weight: normal;
      cursor: pointer;
      white-space: nowrap;
    }

    .radio-group input { 
      width: auto; 
      margin-right: 8px; 
    }

    .qr { 
      display: block; 
      margin: 20px auto; 
      max-width: 200px; 
      width: 100%;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 10px;
      background: white;
    }

    .hidden { 
      display: none !important; 
    }

    .submit-btn { 
      text-align: center; 
      margin-top: 30px; 
    }

    .submit-btn button {
      background: var(--secondary);
      color: #fff;
      padding: 16px 40px;
      border: none;
      border-radius: var(--radius);
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
      width: 100%; /* Full width on mobile */
      max-width: 300px; /* But limit max width */
    }

    .submit-btn button:hover { 
      background: var(--secondary-dark);
      transform: translateY(-2px);
      box-shadow: 0 5px 12px rgba(0,0,0,0.15);
    }

    .doc-note { 
      margin-top: 6px; 
      font-size: 0.9rem; 
      color: var(--text-light); 
      font-style: italic; 
    }

    .guideline-box {
      margin: 20px 0;
      padding: 15px;
      background: #f8f9fa;
      border-radius: var(--radius);
      border-left: 4px solid var(--accent);
    }

    .guideline-box label {
      display: inline-flex;
      align-items: center;
      font-size: 1rem;
      margin-top: 0;
      cursor: pointer;
    }

    .guideline-box input {
      margin: 0 8px 0 0;
      width: auto;
    }

    .readonly-field {
      color: var(--text-light);
      background-color: #f9f9f9;
      cursor: not-allowed;
    }

    ul {
      padding-left: 20px;
      margin: 15px 0;
    }

    li {
      margin-bottom: 8px;
      color: var(--text);
      font-size: 1rem;
    }

    /* File input styling */
    input[type="file"] {
      padding: 12px;
      background: #f8f9fa;
      border: 1px dashed var(--border);
    }

    input[type="file"]::file-selector-button {
      background: var(--accent);
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 4px;
      margin-right: 12px;
      cursor: pointer;
      transition: var(--transition);
      font-size: 0.9rem;
    }

    input[type="file"]::file-selector-button:hover {
      background: #004957;
    }

    /* Responsive design for tablets and larger phones */
    @media (min-width: 481px) {
      body {
        padding: 15px 20px;
        font-size: 16px;
      }
      
      .container {
        padding: 25px 30px;
      }
      
      .submit-btn button {
        width: auto;
      }
    }

    /* Responsive design for desktop */
    @media (min-width: 769px) {
      body {
        font-size: 16px;
      }
      
      .container {
        padding: 30px 35px;
      }
      
      h1 {
        font-size: 1.75rem;
        margin: 15px 0 20px;
      }
      
      input, select, textarea {
        padding: 12px 15px;
        font-size: 15px;
      }
    }

    /* Responsive design for small mobile devices */
    @media (max-width: 480px) {
      .logo {
        max-width: 150px;
      }
      
      h1 {
        font-size: 1.4rem;
      }
      
      h3 {
        font-size: 1.2rem;
      }
      
      .radio-group {
        flex-direction: column;
        gap: 10px;
      }
      
      input[type="file"]::file-selector-button {
        display: block;
        width: 100%;
        margin: 0 0 10px 0;
      }
    }

    /* Very small devices */
    @media (max-width: 350px) {
      .container {
        padding: 15px;
      }
      
      h1 {
        font-size: 1.3rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo-box">
      <img src="logo.png" class="logo" alt="Logo">
    </div>
    <h1>Registration Form for Property Status</h1>
    <p>
      Know the authentic ownership status of the land/house properties before sale or purchase for protecting your future transactions and to create a digital ownership locker - An initiation from Pure Earth Foundation to empower the property owners.
    </p>

    <form id="propertyForm">
      <div class="form-section">
        <label>Email</label>
        <input type="email" name="email" required placeholder="Enter your email address">

        <label>Reg. No</label>
        <input type="text" name="regno" value="Will be sent to your Email after registration." readonly class="readonly-field">

        <label>Name of the property owner (with surname)</label>
        <input type="text" name="ownername" required placeholder="Full name of property owner">

        <label>Name of Applicant (with consent of owner)</label>
        <div class="radio-group">
          <label>
            <input type="radio" name="applicantChoice" value="same" checked> Same as Owner
          </label>
          <label>
            <input type="radio" name="applicantChoice" value="other"> Other
          </label>
        </div>
        <input type="text" name="applicantName" id="applicantName" class="hidden" placeholder="Enter Applicant Name">
      </div>

      <div class="form-section">
        <label>Address for Communication</label>
        <input type="text" name="comm_house" placeholder="HOUSE NO, STREET/ROAD">
        <input type="text" name="comm_village" placeholder="VILLAGE/COLONY">
        <input type="text" name="comm_mandal" placeholder="MANDAL/TOWN">
        <select name="comm_state" id="comm_state">
          <option value="">Select State</option>
          <option value="AP">Andhra Pradesh</option>
          <option value="TG">Telangana</option>
        </select>
        <select name="comm_district" id="comm_district">
          <option value="">Select District</option>
        </select>

        <label>Mobile Number</label>
        <input type="tel" name="mobile" id="mobile" pattern="[0-9]{10}" minlength="10" maxlength="10" required placeholder="10-digit mobile number">

        <label>Aadhar No or PAN No of owner</label>
        <input type="text" name="idnumber" required placeholder="Aadhar or PAN number">

        <label>Upload Aadhar or PAN</label>
        <input type="file" name="idfile">
      </div>

      <div class="form-section">
        <label>Property Type</label>
        <select name="propertyType">
          <option value="Land">Land</option>
          <option value="House">House/Structure</option>
        </select>

        <label>Location/Address of the Property</label>
        <input type="text" name="prop_house" placeholder="HOUSE NO/PLOT NO">
        <input type="text" name="prop_colony" placeholder="NAME OF COLONY/LAYOUT">
        <input type="text" name="prop_village" placeholder="VILLAGE/TOWN">
        <input type="text" name="prop_mandal" placeholder="MANDAL/CITY">
        <select name="prop_state" id="prop_state">
          <option value="">Select State</option>
          <option value="AP">Andhra Pradesh</option>
          <option value="TG">Telangana</option>
        </select>
        <select name="prop_district" id="prop_district">
          <option value="">Select District</option>
        </select>

        <label>Property Details</label>
        <select name="propertyDetails" id="propertyDetails">
          <option value="">Select</option>
          <option value="coords">HAVE COORDINATES OF THE PROPERTY</option>
          <option value="noCoords">DON'T HAVE COORDINATES OF THE PROPERTY</option>
          <option value="survey">SURVEY NO/TOWN SURVEY NO</option>
          <option value="revenue">NAME OF Revenue Village/Block & Ward</option>
        </select>
        <input type="file" name="coordFile" id="coordFile" class="hidden">
        <input type="text" name="surveyText" id="surveyText" class="hidden" placeholder="Enter Survey No">
        <input type="text" name="revenueText" id="revenueText" class="hidden" placeholder="Enter Revenue Village/Block & Ward">

        <label>Brief Description of Request</label>
        <textarea name="briefRequest" placeholder="Please describe your request in detail"></textarea>
      </div>

      <div class="form-section">
        <label>Are you submitting any documents?</label>
        <select name="docSubmit">
          <option value="Yes">Yes</option>
          <option value="No">No</option>
        </select>

        <label>Upload Documents</label>
        <p class="doc-note">
          (Copy of Sale Deed / Agreement of Sale / Pattadhar Pass Book Pages / Any Other Proof of Ownership)
        </p>
        <input type="file" name="documents" multiple>

        <h3>Guidelines</h3>
        <ul>
          <li>Please ensure all details are correct before submission.</li>
          <li>Provide valid proofs for smooth processing.</li>
          <li>Registration fee is non-refundable.</li>
        </ul>
        
        <div class="guideline-box">
          <label for="agreeGuidelines">
            <input type="checkbox" id="agreeGuidelines">I agree to the above guidelines
          </label>
        </div>

        <div id="paymentSection" class="hidden">
          <label>Registration/User charges (INR 2000/-)</label>
          <p>You can pay the registration fee by scanning the QR code below:</p>
          <img src="qr.jpg" alt="QR Code" class="qr">
          <label>Upload the Transaction Copy</label>
          <input type="file" name="transactionCopy">
        </div>
      </div>

      <div class="submit-btn">
        <button type="submit">Submit</button>
      </div>
    </form>
  </div>

  <script>
    // Add input validation to prevent non-numeric characters
    document.getElementById('mobile').addEventListener('input', function(e) {
      // Remove any non-numeric characters
      this.value = this.value.replace(/[^0-9]/g, '');
      
      // Limit to 10 characters
      if (this.value.length > 10) {
        this.value = this.value.slice(0, 10);
      }
    });

    // Optional: Prevent paste of non-numeric content
    document.getElementById('mobile').addEventListener('paste', function(e) {
      const pastedData = e.clipboardData.getData('text');
      if (!/^\d+$/.test(pastedData)) {
        e.preventDefault();
      }
    });

    const applicantChoice = document.getElementsByName("applicantChoice");
    const applicantNameInput = document.getElementById("applicantName");
    applicantChoice.forEach(r => r.addEventListener("change", () => {
      if (document.querySelector('input[name="applicantChoice"]:checked').value === "other") {
        applicantNameInput.classList.remove("hidden");
      } else {
        applicantNameInput.classList.add("hidden");
        applicantNameInput.value = "";
      }
    }));

    const propertyDetails = document.getElementById("propertyDetails");
    propertyDetails.addEventListener("change", () => {
      document.getElementById("coordFile").classList.add("hidden");
      document.getElementById("surveyText").classList.add("hidden");
      document.getElementById("revenueText").classList.add("hidden");
      if (propertyDetails.value === "coords") document.getElementById("coordFile").classList.remove("hidden");
      if (propertyDetails.value === "survey") document.getElementById("surveyText").classList.remove("hidden");
      if (propertyDetails.value === "revenue") document.getElementById("revenueText").classList.remove("hidden");
    });

    document.getElementById("agreeGuidelines").addEventListener("change", function() {
      document.getElementById("paymentSection").classList.toggle("hidden", !this.checked);
    });

    const districts = {
  AP: [
    "Anantapur", "Chittoor", "East Godavari", "Guntur", "Krishna",
    "Kurnool", "YSR Kadapa", "Nellore (SPSR Nellore)", "Prakasam",
    "Srikakulam", "Visakhapatnam", "Vizianagaram", "West Godavari",
    "Anakapalli", "Alluri Sitharama Raju", "Kakinada",
    "Konaseema", "Eluru", "NTR", "Palnadu", "Bapatla",
    "Annamayya", "Sri Sathya Sai", "Tirupati", "Parvathipuram Manyam"
  ],
  TG: [
    "Adilabad", "Bhadradri Kothagudem", "Hanumakonda", "Hyderabad",
    "Jagtial", "Jangaon", "Jayashankar Bhupalpally", "Jogulamba Gadwal",
    "Kamareddy", "Karimnagar", "Khammam", "Komaram Bheem Asifabad",
    "Mahabubabad", "Mahabubnagar", "Mancherial", "Medak",
    "Medchal‚ÄìMalkajgiri", "Mulugu", "Nagarkurnool", "Nalgonda",
    "Narayanpet", "Nirmal", "Nizamabad", "Peddapalli",
    "Rajanna Sircilla", "Ranga Reddy", "Sangareddy", "Siddipet",
    "Suryapet", "Vikarabad", "Wanaparthy", "Warangal Rural",
    "Warangal Urban", "Yadadri Bhuvanagiri"
  ]
};


    function loadDistricts(stateSelect, districtSelect) {
      const state = stateSelect.value;
      districtSelect.innerHTML = "<option value=''>Select District</option>";
      if (districts[state]) {
        districts[state].forEach(d => {
          let opt = document.createElement("option");
          opt.value = d;
          opt.textContent = d;
          districtSelect.appendChild(opt);
        });
      }
    }
    document.getElementById("comm_state").addEventListener("change", function() {
      loadDistricts(this, document.getElementById("comm_district"));
    });
    document.getElementById("prop_state").addEventListener("change", function() {
      loadDistricts(this, document.getElementById("prop_district"));
    });

    function toBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result.split(",")[1]);
        reader.onerror = err => reject(err);
      });
    }

    // üîπ SUBMIT HANDLER
    document.getElementById("propertyForm").addEventListener("submit", async function(e) {
      e.preventDefault();
      const f = e.target;
      const data = {
        email: f.email.value,
        ownername: f.ownername.value,
        applicantChoice: f.applicantChoice.value,
        applicantName: f.applicantChoice.value === "other" ? f.applicantName.value : "",
        comm_house: f.comm_house.value,
        comm_village: f.comm_village.value,
        comm_mandal: f.comm_mandal.value,
        comm_state: f.comm_state.value,
        comm_district: f.comm_district.value,
        mobile: f.mobile.value,
        idnumber: f.idnumber.value,
        propertyType: f.propertyType.value,
        prop_house: f.prop_house.value,
        prop_colony: f.prop_colony.value,
        prop_village: f.prop_village.value,
        prop_mandal: f.prop_mandal.value,
        prop_state: f.prop_state.value,
        prop_district: f.prop_district.value,
        propertyDetails: f.propertyDetails.value,
        surveyText: f.surveyText.value,
        revenueText: f.revenueText.value,
        briefRequest: f.briefRequest.value,
        docSubmit: f.docSubmit.value
      };

      // Upload files
      if (f.idfile.files.length > 0) {
        let file = f.idfile.files[0];
        data.idfile = await toBase64(file);
        data.idfileName = file.name;
        data.idfileType = file.type;
      }

      if (f.coordFile.files.length > 0) {
        let file = f.coordFile.files[0];
        data.coordFile = await toBase64(file);
        data.coordFileName = file.name;
        data.coordFileType = file.type;
      }

      data.documents = [];
      for (let file of f.documents.files) {
        data.documents.push({
          data: await toBase64(file),
          name: file.name,
          type: file.type
        });
      }

      if (f.transactionCopy.files.length > 0) {
        let file = f.transactionCopy.files[0];
        data.transactionCopy = {
          data: await toBase64(file),
          name: file.name,
          type: file.type
        };
      }

      try {
        let res = await fetch("https://script.google.com/macros/s/AKfycbxpv00KdU1DzYJTN4lUWiW4KsDhIoPDy4MWFTNkJ8egkkVTL9i_qlpyPC6eUwRg1AegAg/exec", {
          method: "POST",
          body: JSON.stringify(data)
        });
        let result = await res.json();
        if (result.success) {
          alert("‚úÖ Submitted successfully! Your Reg ID is: " + result.id);
          window.location.reload();
        } else {
          alert("‚ùå Error: " + result.error);
        }
      } catch (err) {
        alert("‚ùå Submission failed: " + err.message);
      }
    });
  </script>
</body>
</html>
